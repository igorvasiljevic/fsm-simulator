(()=>{var t=Boolean(window.location.hostname.startsWith("127.")||window.location.hostname.startsWith("192.")||"localhost"===window.location.hostname||""===window.location.hostname||"[::1]"===window.location.hostname)?"":"/fsm-simulator",e=["/","/lessons/1.html","/lessons/2.html","/lessons/3.html","/lessons/4.html"],s=(()=>{let s=()=>e.indexOf(window.location.pathname.replace(t,"").replace("index.html","")),n=()=>{let n=s();if(0!=n)return t+e[n-1]},i=()=>{let n=s();if(n!=e.length-1)return t+e[n+1]};return{get_previous_page:n,get_next_page:i,home:()=>{window.location.href=t+"/"},previous:()=>{window.location.href=n()},next:()=>{window.location.href=i()}}})(),n=t+"/sw.js",i={get:t=>window.localStorage?.getItem?.(t),set:(t,e)=>window.localStorage?.setItem?.(t,e),remove:t=>window.localStorage?.removeItem?.(t)},o=()=>{i.set("theme",document.documentElement.classList.toggle("light")?"light":"dark")};function a(t,e={},...s){let n=-1===t?document.createDocumentFragment():"svgl"===t?function(t){let e=document.createElement("div");return e.innerHTML=t,e.firstChild}(e.svg):e?.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);e?.svg;for(let t in e)if("style"===t)for(let t in e.style)n.style[t]=e.style[t];else!t.startsWith("on")&&"disabled"!==t&&(t in n||"class"===t||t.startsWith("data-")||t.startsWith("aria-"))?n.setAttributeNS(null,t,e[t]):n[t]=e[t];return n.append(...s.flat()),n}var l="bs",r=e=>{!e||e===l||caches.keys().then((t=>caches.open(t[0]))).then((e=>e.delete(`${t}/localization/${l}.json`))).then((()=>(i.set("language",e),l=e,fetch(`${t}/localization/${l}.json`)))).then((t=>t.json())).then((t=>console.log(t))).catch(console.log)},c='<svg viewBox="-50 -50 100 100" stroke="var(--svg-color)" stroke-width="4" stroke-linecap="round" xmlns="http://www.w3.org/2000/svg"><path fill="var(--svg-color)" d="M0 20a1 1 0 0 0 0-40"/><path fill="none" stroke-width="4.5" d="M0-20a1 1 0 0 0 0 40m0 13v13m0-79v-13M-33 0h-13m79 0h13m-71-25-8-8m8 58-8 8m58-8 8 8m-8-58 8-8"/></svg>',d='<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="var(--svg-color)" stroke-width="5" stroke-linecap="round" d="m10 45 40-30 40 30m-64 5v35h16V65h16v20h16V50"/></svg>',m=class extends HTMLElement{connectedCallback(){let t=this.hasAttribute("home"),e=this.getAttribute("text")||"Finite-State Machines";this.replaceWith(a("header",{class:"fsm-header"},a("div",{class:"topbar"},t?"":a("button",{type:"button",class:"topbar mra",onclick:s.home},a("svgl",{svg:d}),a("span",null,"Home")),a("button",{type:"button",onclick:()=>r("bs"),class:"mla"},"Bosanski"),a("span",null,"•"),a("button",{type:"button",onclick:()=>r("en")},"English"),a("button",{type:"button",class:"topbar",onclick:o,title:"Switch theme","aria-label":"Switch theme"},a("svgl",{svg:c}))),a(t?"h1":"h2",null,e),t?a("h4",null,"by Igor Vasiljević"):"",a("hr",null)))}};customElements.define("fsm-header",m);var h=class extends HTMLElement{connectedCallback(){let t=void 0!==s.get_previous_page(),e=void 0!==s.get_next_page(),n=!t&&e?"Start":"Next";this.replaceWith(a("footer",{class:"fsm-footer"},a("hr",null),a("nav",null,t?a("button",{type:"button",onclick:s.previous},a("span",{class:"rp"},"<"),"Previous"):"",t&&e?a("span",null,"•"):"",e?a("button",{type:"button",onclick:s.next},n,a("span",{class:"lp"},">")):"")))}};customElements.define("fsm-footer",h);var p,u=(t,e=-1/0,s=1/0)=>Math.min(Math.max(t,e),s),f=()=>{document.removeEventListener("pointerdown",p,{capture:!0}),p=void 0},_=navigator?.userAgentData?navigator.userAgentData.mobile:Boolean(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))),g=class extends HTMLElement{connectedCallback(){let t=a("div",{id:"state_"+this.id,class:`state${this.initial?" initial":""}${this.final?" final":""}`},a("input",{type:"text",class:"input noevents",value:this.name??"S",enterKeyHint:"done",maxLength:"10",spellcheck:!1,autocomplete:!1}));this.replaceWith(t);let e=t.firstElementChild;t.title=e.value,t._id=parseInt(this.id),t._name=e.value,t._x=this.x??0,t._y=this.y??0,t._transitions=new Set,t.ondblclick=t=>{t.stopPropagation(),e.focus()},e.onfocus=s=>{t._movable(!1),e.classList.remove("noevents"),this.onfocus?.(t)},e.ondblclick=t=>{e.setSelectionRange(0,e.value.length)},e.onkeydown=s=>{switch(s.key){case"Escape":e.value=t._name;case"Enter":e.blur()}},e.onblur=s=>{let n=e.value.trim();t.title=e.value=t._name=n||t._name,e.classList.add("noevents"),t._movable(!0)},((t,e={})=>{let s=0,n=0,i=null,o=!1;t._styles=window.getComputedStyle(t.parentElement,null),t._styles._padding_left=parseFloat(t._styles.paddingLeft),t._styles._padding_right=parseFloat(t._styles.paddingRight),t._styles._padding_top=parseFloat(t._styles.paddingTop),t._styles._padding_bottom=parseFloat(t._styles.paddingBottom),t._styles._offset_x=(t._styles._padding_left-t._styles._padding_right)/2,t._styles._offset_y=(t._styles._padding_top-t._styles._padding_bottom)/2;let a=t.offsetWidth/2+t._styles._padding_left-t._styles._offset_x,l=t.offsetWidth/2+t._styles._padding_right+t._styles._offset_x,r=t.offsetHeight/2+t._styles._padding_top-t._styles._offset_y,c=t.offsetHeight/2+t._styles._padding_bottom+t._styles._offset_y;function d(e){t.onpointermove=e?h:t=>t.stopPropagation()}function m(a){try{t.releasePointerCapture(i)}catch(t){}i=null,s=n=0,o&&e.click?.(a),o=!1}function h(e){if(e.pointerId!==i)return;e.stopPropagation();let o=t.parentElement._scale??1;t._x+=(e.clientX-s)/o,t._y+=(e.clientY-n)/o,s=e.clientX,n=e.clientY,p()}function p(){let s=t.parentElement.offsetWidth/2,n=t.parentElement.offsetHeight/2;t._x=u(t._x,a-s,s-l),t._y=u(t._y,r-n,n-c),t._offset_x=t._x-a+s,t._offset_y=t._y-r+n,t.style.transform=`translate(${t._offset_x}px, ${t._offset_y}px)`,e.move?.()}function f({x:e,y:s}={}){t._x=e??t._x,t._y=s??t._y,p()}delete t._styles,t._move=f,t._movable=d,t.onpointerdown=function(e){if(e.target._move){i=e.pointerId;try{t.setPointerCapture(i)}catch(t){}s=e.clientX,n=e.clientY,o=!0,setTimeout((()=>o=!1),100)}},t.onpointerup=m,t.onpointercancel=m,d(!0),f(t._x??0,t._y)})(t,{click:this.onclick,move:()=>{for(let e of t._transitions)e._reposition()}})}};customElements.define("fsm-state",g);var v=-.25,y=class extends HTMLElement{connectedCallback(){let t=!this.from,e=this.from===this.to,s=a("svgl",e?{svg:'<svg width="45" height="50" xmlns="http://www.w3.org/2000/svg"><title/><g class="noevents" fill="none" stroke="var(--transition-color)" stroke-width="2"><path id="a" d="M10 43a18.5 18.5 0 1 1 24 0"/><path d="m36 31-1 12M44 36l-9.5 7"/><circle style="display:none" r="2.5" fill="var(--state-bg-color-current)" stroke="none"><animateMotion dur="0.2s" begin="indefinite" fill="freeze"><mpath href="#a"/></animateMotion></circle></g></svg>'}:{svg:'<svg style="width:60px;height:26px" xmlns="http://www.w3.org/2000/svg"><title/><g class="noevents" stroke="var(--transition-color)" stroke-width="2"><line y1="13" x2="100%" y2="13"/><path d="m0 13 10-5M0 13l10 5"/><circle style="display:none" r="2.5" cx="100%" cy="50%" fill="var(--state-bg-color-current)" stroke="none"><animate attributeName="cx" from="100%" to="0" dur="0.2s" begin="indefinite" fill="freeze"/></circle></g></svg>'}),n=a("div",{class:`transition${t?" initial":""}${e?" loop":""}`},s,a("input",{type:"text",class:"input noevents",value:t?"Start":this.value??"",disabled:t,enterKeyHint:"done",spellcheck:!1,autocomplete:!1}));this.replaceWith(n),n._from=this.from,n._to=this.to,!t&&!e&&(n._opposite=n.parentElement.querySelector(`#transition_${n._to._id}_${n._from._id}`)),n._opposite&&(n._opposite._opposite=n);let i=n.querySelector(".input");if(n._reposition=(o=!1)=>{if(t){s.style.transform="rotate(180deg)";let t=n._to._offset_x-n.offsetWidth,e=n._to._offset_y+s.clientHeight/2;n.style.transform=`translate(${t}px, ${e}px)`}else if(e){let t=n._to._offset_x+(n._to.offsetWidth-n.offsetWidth)/2,e=n._to._offset_y+(n._to.offsetHeight-s.clientHeight)/2-40;n.style.transform=`translate(${t}px, ${e}px)`}else{let t,e=n._to.offsetWidth/2,a=n._from._offset_x+e,l=n._from._offset_y+e,r=n._to._offset_x+e,c=n._to._offset_y+e,d=Math.atan2(l-c,a-r);s.style.transform=`rotate(${d}rad)`,n._opposite?(o||n._opposite._reposition(!0),a+=e*Math.cos(d+v+Math.PI),l+=e*Math.sin(d+v+Math.PI),r+=e*Math.cos(d-v),c+=e*Math.sin(d-v),t=Math.hypot(a-r,l-c)):t=Math.hypot(a-r,l-c)-2*e,s.style.width=`${t}px`,n._x=(a+r-n.offsetWidth)/2,n._y=(l+c-s.clientHeight)/2,n.style.transform=`translate(${n._x}px, ${n._y}px)`;let m=d+Math.PI/2,h=10*Math.cos(m),p=10*Math.sin(m);i.style.transform=`translate(${h}px, ${p}px)`}},n._reposition(),n._to._transitions.add(n),t)return;n._from._transitions.add(n);let o=s.querySelector("title");o.textContent=i.value,n.id=`transition_${n._from._id}_${n._to._id}`,n._value=this.value||"",n._delete=()=>{n._from._transitions.delete(n),n.remove(),n._opposite&&(delete n._opposite._opposite,n._opposite._reposition())};let l,r=s.querySelector("circle");n._animate=(t=!1)=>new Promise(((e,s)=>{r.firstElementChild.setAttributeNS(null,"dur",t?"0.08s":"0.2s"),r.firstElementChild.addEventListener("endEvent",(()=>{r.style.display="none",e()}),{once:!0}),r.style.display="initial",r.firstElementChild.beginElement()})),s.onclick=this.onclick,s.ondblclick=t=>{t?.stopPropagation?.(),setTimeout((()=>i.focus()),1)},i.onfocus=t=>{l=i.value,i.classList.remove("noevents"),this.onfocus?.(n)},i.ondblclick=t=>{i.setSelectionRange(0,i.value.length)},i.onkeydown=t=>{switch(t.key){case"Escape":i.value=n._value;case"Enter":i.blur()}},i.oninput=t=>{i.value=this.input(i.value)},i.onblur=t=>{i.classList.add("noevents");let e=[...new Set(i.value.replaceAll(",","").replaceAll(" ","").split(""))],s=e.sort().join(",");o.textContent=i.value=n._value=s||n._value,n._value?n._value!==l&&this.change?.(e):n._delete(),l=n._value},this.value||setTimeout((()=>i.focus()),100)}};customElements.define("fsm-transition",y);var b=0,w=2,x=class{constructor({type:t,states:e,initial_state:s,final_states:n,transitions:i,state_info:o,string:a}={}){this.type=t??b,this.states=new Set(e),this.initial_state=s??0,this.final_states=new Set(n),this.transitions={},this.states.add(this.initial_state);for(let t in i??{})for(let e in i[t]??{})for(let s of i[t][e]??[])this.add_transition(t,s,e);this.state_info=o,this.string=a}get_next_id(){let t=0;for(;this.states.has(t);)++t;return t}add_state(t){this.states.add(t),this.transitions[t]={}}remove_state(t){if(t===this.initial_state)return!1;this.final_states.delete(t),delete this.transitions[t];for(let e in this.transitions)this.remove_transition(e,t);return this.states.delete(t)}add_transition(t,e,s){"$"===s&&this.type!==w||(this.transitions[t]||(this.transitions[t]={}),(!this.transitions[t][s]||this.type===b)&&(this.transitions[t][s]=new Set),this.transitions[t][s].add(e))}remove_transition(t,e){for(let s in this.transitions[t])this.transitions[t][s]?.delete?.(e),0===this.transitions[t][s]?.size&&delete this.transitions[t][s]}epsilon_transition(t){let e,s=new Set([...t]),n=s.size;for(;n!==e;){n=s.size;let t=s;for(let e of t)if(this.transitions[e]&&this.transitions[e].$)for(let t of this.transitions[e].$)s.add(t);e=s.size}return s}start(){return this.type===w?[...this.epsilon_transition(new Set([this.initial_state]))]:[this.initial_state]}transition(t,e){let s=this.transitions?.[t]?.[e];return s?(this.type===w&&(s=this.epsilon_transition(s)),[...s]):[]}transition_states(t,e){let s=new Set;for(let n of t)for(let t of this.transition(n,e))s.add(t);return[...s]}toString(){return JSON.stringify(this,((t,e)=>e instanceof Set?[...e]:e))}},k={"Initial and final":{states:[0,1],initial_state:0,final_states:[1],transitions:{},type:0,state_info:{0:{name:"q0",x:-65,y:0},1:{name:"q1",x:65,y:0}}},"Ends in b":{states:[0,1],initial_state:0,final_states:[1],transitions:{0:{a:[0],b:[1]},1:{a:[0],b:[1]}},type:1,state_info:{0:{name:"q0",x:-65,y:0},1:{name:"q1",x:65,y:0}},string:"aabbaabb"},"Nondeterministic transition":{states:[0,1,2],initial_state:0,final_states:[],transitions:{0:{a:[1,2]}},type:2,state_info:{0:{name:"q0",x:-65,y:0},1:{name:"q1",x:65,y:-50},2:{name:"q2",x:65,y:50}},string:"aa"},"Epsilon transition":{states:[0,1,2,3,4],initial_state:0,final_states:[3,4],transitions:{0:{a:[1]},1:{$:[2],b:[3]},2:{c:[4]}},type:2,state_info:{0:{name:"q0",x:-95,y:-20},1:{name:"q1",x:0,y:-20},2:{name:"q2",x:0,y:80},3:{name:"q3",x:95,y:-20},4:{name:"q4",x:95,y:80}},string:"ad"},Fifth:{states:[0,1,2,3],initial_state:0,final_states:[3],transitions:{0:{c:[0],a:[1],b:[2]},1:{a:[1,2],c:[1]},2:{a:[1],c:[2],b:[3],$:[3]},3:{b:[3],c:[3]}},type:2,state_info:{0:{name:"q0",x:-110,y:0},1:{name:"q1",x:0,y:-110},2:{name:"q2",x:110,y:0},3:{name:"q3",x:0,y:110}},string:"ccaccaccbccbcc"}},E=class extends HTMLElement{connectedCallback(){let t,e=a("div",{class:"fsm-notify hide"});this.replaceWith(e),this._show=s=>{clearTimeout(t),e.innerHTML=s,e.classList.remove("hide"),t=setTimeout((()=>e.classList.add("hide")),1500)}}};customElements.define("fsm-notify",E);var S=a("fsm-notify",null);document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(S)}),{once:!0});var M=t=>S._show(t),L=class extends HTMLElement{connectedCallback(){let t=this.value??"",e=a("div",{class:"fsm-string"},a("input",{type:"text",placeholder:"test string",class:"fsm-string-input",value:t,enterKeyHint:"done",spellcheck:!1,autocomplete:!1}),a("div",{class:"fsm-pseudo-input"},t));this.replaceWith(e);let s=e.querySelector(".fsm-string-input"),n=e.querySelector(".fsm-pseudo-input");e._get_value=()=>s.value,e._set_value=t=>{n.innerText=s.value=t.replaceAll("$","")},e._highlight=t=>{if(s.disabled=!0,n.classList.remove("hidden"),t<n.innerText.length){if(n.innerHTML=n.innerText.slice(0,t)+`<span class="highlight">${n.innerText[t]}</span>`+n.innerText.slice(t+1),n.scrollWidth!==n.clientWidth){let t=n.querySelector(".highlight"),e=t.offsetLeft/n.scrollWidth*(n.clientWidth-3*t.offsetWidth),s=Math.round(t.offsetLeft-e-t.offsetWidth);n.scroll(s,0)}}else n.innerHTML=n.innerText},e._reset=()=>{s.disabled=!1,n.innerHTML=n.innerText,n.classList.add("hidden"),this.edit?.()},s.onfocus=()=>{_&&s.scrollIntoView()},s.onblur=t=>{n.innerText=s.value},s.onkeydown=t=>{switch(t.key){case"Escape":case"Enter":s.blur()}},s.oninput=t=>{e._set_value(s.value)}}};customElements.define("fsm-string",L);var q=class extends HTMLElement{connectedCallback(){let t=new x(k.Fifth),e=t.toString(),s=t.start();s=t.transition_states(s,"a"),s=t.transition_states(s,"a"),s=t.transition_states(s,"a"),s=t.transition_states(s,"a"),s=t.transition_states(s,"a"),s=t.transition_states(s,"a");let n=t.toString();return void(e===n?console.log("All good"):(console.log("Different"),console.log(e),console.log(n)))}};document.addEventListener("DOMContentLoaded",(()=>{customElements.define("fsm-canvas",q)}),{once:!0});var $=a("a",{download:"fsm.json",style:{display:"none"},onclick:t=>t.stopPropagation()}),T=a("input",{type:"file",accept:".json",style:{display:"none"},onclick:t=>t.stopPropagation()}),W=new FileReader;document.addEventListener("DOMContentLoaded",(()=>{document.body.append($,T)}),{once:!0});var C={download:(t,e)=>{$.setAttribute("download",t),$.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),$.click()},upload:()=>new Promise(((t,e)=>{T.onchange=s=>{try{let e=T.files?.[0];e&&(W.onload=()=>{T.value=null,W.onload=void 0,t(W.result)},W.readAsText(e,"utf-8"))}catch(t){e(t)}},T.click()}))},H=class extends HTMLElement{connectedCallback(){let t=a("div",{class:"menu-container"},a("button",{type:"button",id:"menu-btn",class:"img-btn",title:"Menu","aria-label":"Menu"},a("svgl",{svg:'<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><g fill="var(--svg-color)"><circle r="10" cx="50" cy="20"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="50" cy="80"/></g></svg>'})),a("div",{class:"menu menu-hidden"},[...this.children]));this.replaceWith(t);let e=t.querySelector(".menu"),s=[],n=t=>{for(let e of t.querySelectorAll("button"))e.disabled=!0;t.classList.add("menu-hidden")};n(e);let i=()=>{for(;s.length;)s.pop().classList.add("menu-hidden");n(e)},o=t=>{s.push(t);for(let e of t.querySelectorAll(":scope > button"))e.disabled=!1;document.activeElement.matches(":focus-visible")&&t.firstElementChild.focus(),t.onkeydown=e=>{"Tab"===e.key&&(!e.shiftKey&&document.activeElement===t.lastElementChild||e.shiftKey&&document.activeElement===t.firstElementChild)&&(t.onkeydown=void 0,n(s.pop()))},t.classList.remove("menu-hidden")};t.onclick=a=>{"menu-btn"===a.target.id?0===s.length?(((t,e)=>{p=s=>{s.target!==t&&!t.contains(s.target)&&(e?.(),f())},document.addEventListener("pointerdown",p,{capture:!0})})(t,i),o(e)):(n(s.pop()),0===s.length&&f()):a.target.submenu&&o(e.querySelector("#"+a.target.submenu))}}};customElements.define("fsm-menu",H);var z=class extends HTMLElement{connectedCallback(){let t=a("fsm-canvas",{load:!0,fullsize:!0}),e=a("fsm-menu",null,a("button",{type:"button",submenu:"menu-examples"},"Examples"),a("div",{id:"menu-examples",class:"menu submenu menu-hidden"},Object.keys(k).map((e=>a("button",{type:"button",onclick:()=>t._set_fsm(new x(k[e]))},e)))),a("button",{type:"button",onclick:()=>{t._set_fsm(new x)}},"New"),a("button",{type:"button",onclick:()=>{let e=i.get("fsm");e?t._set_fsm(new x(JSON.parse(e))):M("No saved data")}},"Load"),a("button",{type:"button",onclick:()=>{C.upload().then((e=>t._set_fsm(new x(JSON.parse(e)))))}},"Upload"),a("button",{type:"button",onclick:()=>{i.set("fsm",t._get_fsm().toString()),M("Data saved")}},"Save"),a("button",{type:"button",onclick:()=>{let e=prompt("Enter file name","fsm.json");e&&C.download(e,t._get_fsm().toString())}},"Download"),a("button",{type:"button",onclick:o,class:"theme img-btn",title:"Switch theme","aria-label":"Switch theme"},a("svgl",{svg:c})));this.replaceWith(a(-1,null,a("button",{type:"button",class:"img-btn home",onclick:s.home,title:"Home","aria-label":"Home"},a("svgl",{svg:d})),e,t))}};customElements.define("fsm-simulator",z),"serviceWorker"in navigator&&navigator.serviceWorker.register(n),(()=>{let t=i.get("theme");("light"===t||void 0===t&&window.matchMedia("(prefers-color-scheme: light)")?.matches)&&o()})()})();